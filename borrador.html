<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/styles.css">

</head>
<body>

<main>
    
<section>

    <h2 class="titulos">Películas populares</h2>
    <div class="section" id="pelPopulares">
    

    </div>

    <h2 class="titulos">Series populares</h2>
    <div class="section" id="serPopulares">

    </div>

    <h2 class="titulos">Mejor calificados</h2>
    <div class="section" id="mejorCalificado">

    </div>
</section>

</main>


<script>

let cargarPeliculas = async () => {
    try {
        let respuesta = await fetch(`https://api.themoviedb.org/3/movie/popular?api_key=aad4ccb8efdd15fad341576d3301e95e`);
        let datos = await respuesta.json();
        let peliculas = '';

        datos.results.slice(0, 12).forEach((pelicula, index) => {
            peliculas += `
                <div class="pelicula">
                    <img class="imgB" src="https://image.tmdb.org/t/p/w500/${pelicula.poster_path}">
                    <h3 class="titulo">${pelicula.title}</h3>
                    <p>Fecha de estreno: <br>${pelicula.release_date}</p>
                </div>
            `;
        });

        document.getElementById('pelPopulares').innerHTML = peliculas;

    } catch (error) {
        console.log(error);
    }
    let peliculas = document.querySelectorAll('.pelicula');

    peliculas.forEach(function(pelicula) {
        pelicula.addEventListener('click', function() {
            let titulo = pelicula.querySelector('.titulo').innerText;
            let detalleURL = `detalle.html?titulo=${encodeURIComponent(titulo)}`;
            window.location.href = detalleURL;
        });
    });
}
cargarPeliculas();


let cargarSeries = async () => {
    try {
        let respuesta = await fetch(`https://api.themoviedb.org/3/tv/popular?api_key=aad4ccb8efdd15fad341576d3301e95e`);
        let datos = await respuesta.json();
        let series = '';

     
        datos.results.slice(0, 12).forEach((serie, index) => {
            series += `
                <div class="pelicula">
                    <img class="imgB" src="https://image.tmdb.org/t/p/w500/${serie.poster_path}">
                    <h3 class="titulo">${serie.name}</h3>
                    <p>Fecha de estreno: <br>${serie.first_air_date}</p>
                </div>
            `;
        });

        document.getElementById('serPopulares').innerHTML = series;

    } catch (error) {
        console.log(error);
    }
}
cargarSeries();

let cargarMejorCalificadas = async () => {
    try {
        let respuesta = await fetch(`https://api.themoviedb.org/3/movie/top_rated?api_key=aad4ccb8efdd15fad341576d3301e95e`);
        let datos = await respuesta.json();
        let peliculas = '';

        datos.results.slice(0, 12).forEach((pelicula, index) => {
            peliculas += `
                <div class="pelicula">
                    <img class="imgB" src="https://image.tmdb.org/t/p/w500/${pelicula.poster_path}">
                    <h3 class="titulo">${pelicula.title}</h3>
                    <p>Fecha de estreno: <br>${pelicula.release_date}</p>
                </div>
            `;
        });

        document.getElementById('mejorCalificado').innerHTML = peliculas;

    } catch (error) {
        console.log(error);
    }
}
cargarMejorCalificadas();


    // Agregar evento de clic a cada película

    document.addEventListener('click', function(event) {
        // Verificar si el clic fue en un elemento con la clase 'pelicula'
        if (event.target.classList.contains('pelicula')) {
            // Obtener el título de la película clicada
            let titulo = event.target.querySelector('.titulo').innerText;
            // Construir la URL para la página "resultados.html" con el título como parámetro
            let resultadosURL = `resultados.html?titulo=${encodeURIComponent(titulo)}`;
            // Redirigir al usuario a la página de resultados
            window.location.href = resultadosURL;
        }
    });



</script>
</body>
</html>


